apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- gcpauth-controller-clusterrole.yaml
- gcpauth-mutwebhookcfg.yaml
- profiles.gcpauth.policies.nuxeo.io-crd.yaml
commonlabels:
  app.kubernetes.io/instance: gcpauth
components:
- ../controller
patches:
- path: controller-deploy.yaml
transformers:
- |-
  apiVersion: builtin
  kind: PrefixSuffixTransformer
  metadata:
    name: controller
  prefix: gcpauth-
  fieldSpecs:
  - kind: Certificate
    path: metadata/name
  - kind: ClusterRoleBinding
    path: metadata/name
  - kind: ClusterRoleBinding
    path: roleRef/name
  - kind: ClusterRoleBinding
    path: subjects/name
  - kind: Deployment
    path: metadata/name
  - kind: ServiceAccount
    path: metadata/name
  - kind: Service
    path: metadata/name
